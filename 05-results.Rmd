# Results

```{r}
library(tidyverse)
library(patchwork)
library(lubridate)

vix <- read.csv("https://cdn.cboe.com/api/global/us_indices/daily_prices/VIX_History.csv")
ff <- read_csv("F-F_Research_Data_Factors_daily.csv", skip = 3, n_max = 25105)
ind <- read_csv("5_Industry_Portfolios_Daily.csv", skip = 9, n_max = 25105)
na <- read_csv("North_America_5_Factors_Daily.csv", skip = 6, n_max = 8132)
erp <- read_csv("Europe_5_Factors_Daily.csv", skip = 6, n_max = 8132)
asa <- read_csv("Asia_Pacific_ex_Japan_5_Factors_Daily.csv", skip = 6, n_max = 8132)
jp <- read_csv("Japan_5_Factors_Daily.csv", skip = 6, n_max = 8132)

ff <- ff %>% rename("Mkt.RF" = "Mkt-RF", "X" = "...1")
ind <- ind %>% rename("X" = "...1")
na <- na %>% rename("NA_" = "Mkt-RF", "X" = "...1") %>% select(NA_, X)
erp <- erp %>% rename("ERP_" = "Mkt-RF", "X" = "...1") %>% select(ERP_, X)
asa <- asa %>% rename("ASA_" = "Mkt-RF", "X" = "...1") %>% select(ASA_, X)
jp <- jp %>% rename("JP_" = "Mkt-RF", "X" = "...1") %>% select(JP_, X)
cnt <- merge(na, erp, by = c("X" = "X")) %>%
  merge(asa, by = c("X" = "X")) %>% merge(jp, by = c("X" = "X"))

vix$DATE <- as.Date(vix$DATE, format = '%m/%d/%Y')
ff$DATE <- as.Date(as.character(ff$X), format = '%Y%m%d')
ind$DATE <- as.Date(as.character(ind$X), format = '%Y%m%d')
cnt$DATE <- as.Date(as.character(cnt$X), format = '%Y%m%d')

vix <- vix %>% mutate(dVIX = CLOSE - lag(CLOSE))

vix <- vix %>% filter(year(DATE) >= 2001)
ff <- ff %>% filter(year(DATE) >= 2001)
ind <- ind %>% filter(year(DATE) >= 2001)
cnt <- cnt %>% filter(year(DATE) >= 2001)

ff_n <- nrow(ff)
cnt_n <- nrow(cnt)
ff$US_V[1] <- 100 * (1 + ff$Mkt.RF[1]/100)
ind_v <- ind
cnt_v <- cnt
for(j in 2:6){
    ind_v[1, j] <- 100 * (1 + ind[1, j]/100)
}
for(j in 2:5){
    cnt_v[1, j] <- 100 * (1 + cnt[1, j]/100)
}
for(i in 2:ff_n){
  ff$US_V[i] <- ff$US_V[i-1] * (1 + ff$Mkt.RF[i]/100)
  for(j in 2:6){
    ind_v[i , j] <- ind_v[i-1, j] * (1 + ind_v[i, j]/100)
  }
}
for(i in 2:cnt_n){
  for(j in 2:5){
    cnt_v[i , j] <- cnt_v[i-1, j] * (1 + cnt_v[i, j]/100)
  }
}

ind_names <- ind %>% select(-c(X, DATE)) %>% names
cnt_names <- cnt %>% select(-c(X, DATE)) %>% names
names(ind_v) <- c("X", paste(ind_names, "V", sep = "_"), "DATE")
names(cnt_v) <- c("X", paste(c("NA", "ERP", "ASA", "JP"),
                             "V", sep = "_"), "DATE")
ind <- merge(ind, ind_v, by = c("DATE" = "DATE"))
cnt <- merge(cnt, cnt_v, by = c("DATE" = "DATE"))
remove(ind_v)
remove(cnt_v)

ff$DATE[1:(ff_n-1)] <- ff$DATE[2:ff_n]
ind$DATE[1:(ff_n-1)] <- ind$DATE[2:ff_n]
cnt$DATE[1:(cnt_n-1)] <- cnt$DATE[2:cnt_n]
ff <- ff[-ff_n,]
ind <- ind[-ff_n,]
cnt <- cnt[-cnt_n,]
df <- merge(vix, ff, by = c("DATE" = "DATE")) %>%
  merge(ind, by = c("DATE" = "DATE")) %>% merge(cnt, by = c("DATE" = "DATE"))
df <- rename(df, US_R = Mkt.RF, VIX = CLOSE, Cnsmr_R = Cnsmr,
             Manuf_R = Manuf, HiTec_R = HiTec, Hlth_R = Hlth,
             Other_R = Other, NA_R = NA_, ERP_R = ERP_,
             ASA_R = ASA_, JP_R = JP_)
df$US_R_n <- df$US_R
df$Cnsmr_R_n <- df$Cnsmr_R
df$Manuf_R_n <- df$Manuf_R
df$HiTec_R_n <- df$HiTec_R
df$Hlth_R_n <- df$Hlth_R
df$Other_R_n <- df$Other_R
df$NA_R_n <- df$NA_R
df$ERP_R_n <- df$ERP_R
df$ASA_R_n <- df$ASA_R
df$JP_R_n <- df$JP_R

df$US_R_n[df$US_R > 0] <- 0
df$Cnsmr_R_n[df$Cnsmr_R > 0] <- 0
df$Manuf_R_n[df$Manuf_R > 0] <- 0
df$HiTec_R_n[df$HiTec_R > 0] <- 0
df$Hlth_R_n[df$Hlth_R > 0] <- 0
df$Other_R_n[df$Other_R > 0] <- 0
df$NA_R_n[df$NA_R > 0] <- 0
df$ERP_R_n[df$ERP_R > 0] <- 0
df$ASA_R_n[df$ASA_R > 0] <- 0
df$JP_R_n[df$JP_R > 0] <- 0

max_VIX <- max(df$VIX)
max_dVIX <- max(df$dVIX)
min_R <- min(df$US_R)
max_R <- max(df$US_R)
```

Q1) Can we use VIX to predict future drops of stock prices, and are there any specific types of recession periods that VIX could foresee more easily?

To analyze the VIX and average stock return data in US markets, we first compared them in the graph below. The blue line shows VIX value, the red curve is the non-parametric loess smoother for VIX value, the swinging line around zero represents US average portfolio return (%), and the periods colored by green indicate high VIX periods. This graph clearly shows that high VIX leads to high volatility of the US average stock return. Especially, a very high VIX causes intense fluctuations of the return.
```{r}
df_c <- df %>% select(US_R, DATE, VIX) %>%
  gather(key, Value, -DATE)
ggplot() +
  annotate("rect", xmin = as.Date("2002-7-1"), xmax = as.Date("2003-6-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2008-8-1"), xmax = as.Date("2009-7-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2011-7-1"), xmax = as.Date("2012-2-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2020-2-1"), xmax = as.Date("2021-3-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  layer(
    data = df_c, 
    mapping = aes(DATE, Value, col = key), 
    geom = "line", 
    stat = "identity", 
    position = "identity"
  ) +
  geom_smooth(df, mapping = aes(DATE, VIX),
              method = "loess", span = 0.1, colour = "red")  +
  annotate("text", x = as.Date("2003-6-1"), y = 60,
           label = "Jul. 02 - May 03", color = "black", hust = 0) +
  annotate("text", x = as.Date("2009-7-1") - 300, y = 70,
           label = "Aug. 08 - Jun. 09", color = "black", hust = 0) +
  annotate("text", x = as.Date("2012-2-1") + 100, y = 60,
           label = "Jul. 11 - Jan. 12", color = "black", hust = 0) +
  annotate("text", x = as.Date("2021-3-1") - 500, y = 70,
           label = "Feb. 20 - Feb. 21", color = "black", hust = 0) +
  labs(subtitle = "Comparison of US Average Portfolio Return and VIX") +
  theme_grey(16)
```

The graph below shows comparison between VIX and actual cumulative changes of US average portfolio value. We can see a high VIX leads to not only high volatility but also huge fall of stock values. Especially, from August 2008 to June 2009 and from February 2020 to February 2021, there are comparably high VIX values and sharp plunges of stock values. Since they are the periods of the 2008 financial crisis and the COVID-19 Crisis, times we know were of great worry and uncertainty in markets, the VIX must be capturing trader's fears.

```{r}
df_c <- df %>% select(DATE, US_V, VIX) %>%
  gather(key, Value, -DATE)
ggplot()  +
  annotate("rect", xmin = as.Date("2002-7-1"), xmax = as.Date("2003-6-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2008-8-1"), xmax = as.Date("2009-7-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2011-7-1"), xmax = as.Date("2012-2-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2020-2-1"), xmax = as.Date("2021-3-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  layer(
    data = df_c, 
    mapping = aes(DATE, Value, col = key), 
    geom = "line", 
    stat = "identity", 
    position = "identity"
  ) +
  geom_smooth(df, mapping = aes(DATE, VIX),
              method = "loess", span = 0.1, colour = "red") +
  annotate("text", x = as.Date("2003-6-1"), y = 300,
           label = "Jul. 02 - May 03", color = "black", hust = 0) +
  annotate("text", x = as.Date("2009-7-1") - 300, y = 350,
           label = "Aug. 08 - Jun. 09", color = "black", hust = 0) +
  annotate("text", x = as.Date("2012-2-1") + 100, y = 300,
           label = "Jul. 11 - Jan. 12", color = "black", hust = 0) +
  annotate("text", x = as.Date("2021-3-1") - 500, y = 350,
           label = "Feb. 20 - Feb. 21", color = "black", hust = 0) +
  labs(subtitle = "Comparison of US Average Portfolio Value and VIX") +
  theme_grey(16)
```

The next graph with boxplots and a regression curve tells us implications about concrete threshold of VIX values indicating the high level of concerns in the market. US_R_n on y axis is non-positive values of US average stock returns, which means the US average stock returns whose positive values were changed to zero. We focused on these non-positive values because our goal is to confirm the possibility of using the VIX to avoid investment risks, not to improve total trading return. The graph indicates clear negative correlation with narrow confidence interval between the return and VIX. Also, the boxplots imply that above 70 or more VIX values have strong potential of market crisis. This implication makes sense because only the 2008 financial crisis and the COVID-19 Crisis caused such a high values from 2001 to date.


```{r}
df <- df %>% mutate(bin = cut_width(VIX, 5))

ggplot(df, aes(x = VIX, y = US_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  labs(subtitle = "Boxplot and Regression of Non-positive Returns on VIX") +
  theme_grey(16)
```


```{r}
df2006 <- df %>% filter(year(DATE) <= 2006)
df2011 <- df %>% filter(year(DATE) > 2006 & year(DATE) <= 2011)
df2016 <- df %>% filter(year(DATE) > 2011 & year(DATE) <= 2016)
df2021 <- df %>% filter(year(DATE) > 2016)

g_06 <- ggplot(df2006, aes(x = VIX, y = US_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, 0) + labs(subtitle = "2001-2006")
g_11 <- ggplot(df2011, aes(x = VIX, y = US_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, 0) + labs(subtitle = "2006-2011")
g_16 <- ggplot(df2016, aes(x = VIX, y = US_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, 0) + labs(subtitle = "2011-2016")
g_21 <- ggplot(df2021, aes(x = VIX, y = US_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, 0) + labs(subtitle = "2016-2021")
g_06 + g_11 + g_16 + g_21
```

```{r}
g_06 <- ggplot(df2006, aes(x = VIX, y = US_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, max_R) + labs(subtitle = "2001-2006")
g_11 <- ggplot(df2011, aes(x = VIX, y = US_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, max_R) + labs(subtitle = "2006-2011")
g_16 <- ggplot(df2016, aes(x = VIX, y = US_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, max_R) + labs(subtitle = "2011-2016")
g_21 <- ggplot(df2021, aes(x = VIX, y = US_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth() +
  xlim(0, max_VIX) + ylim(min_R, max_R) + labs(subtitle = "2016-2021")
g_06 + g_11 + g_16 + g_21
```

Q2) Are there more appropriate industries to use VIX for predicting the future drops? 

```{r}
library(GGally)
df_p <- df2021[names(df) %in% c("VIX", "Cnsmr_R_n", "Manuf_R_n", 
                                "HiTec_R_n", "Hlth_R_n", "Other_R_n")]
ggpairs(df_p) +
  labs(subtitle = "Pairwise Analysis for VIX and Non-positive Return in Each Industry")
```

```{r}
df_V5 <- df %>% mutate(VIX = VIX * 5 - 400)
df_c <- df_V5 %>% select(DATE, Cnsmr_V, Manuf_V, HiTec_V,
                      Hlth_V, Other_V, VIX) %>%
  gather(key, Value, -DATE)
ggplot() +
  annotate("rect", xmin = as.Date("2002-7-1"), xmax = as.Date("2003-6-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2008-8-1"), xmax = as.Date("2009-7-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2011-7-1"), xmax = as.Date("2012-2-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2020-2-1"), xmax = as.Date("2021-3-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  layer(
    data = df_c, 
    mapping = aes(DATE, Value, col = key, alpha = 0.8), 
    geom = "line", 
    stat = "identity", 
    position = "identity"
  ) +
  geom_smooth(df_V5, mapping = aes(DATE, VIX),
              method = "loess", span = 0.1, colour = "red") +
  annotate("text", x = as.Date("2003-6-1"), y = -100,
           label = "Jul. 02 - May 03", color = "black", hust = 0) +
  annotate("text", x = as.Date("2009-7-1") - 300, y = -20,
           label = "Aug. 08 - Jun. 09", color = "black", hust = 0) +
  annotate("text", x = as.Date("2012-2-1") + 300, y = -100,
           label = "Jul. 11 - Jan. 12", color = "black", hust = 0) +
  annotate("text", x = as.Date("2021-3-1") - 500, y = -20,
           label = "Feb. 20 - Feb. 21", color = "black", hust = 0) +
  labs(subtitle = "Comparison of US Value and VIX") +
  theme_grey(16)
```
```{r}
g_c <- ggplot(df, aes(x = VIX, y = Cnsmr_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_m <- ggplot(df, aes(x = VIX, y = Manuf_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_hi <- ggplot(df, aes(x = VIX, y = HiTec_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_hl <- ggplot(df, aes(x = VIX, y = Hlth_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_o <- ggplot(df, aes(x = VIX, y = Other_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_c + g_m + g_hi + g_hl + g_o

```

```{r}
###bimyou
g_c <- ggplot(df, aes(x = VIX, y = Cnsmr_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_m <- ggplot(df, aes(x = VIX, y = Manuf_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_hi <- ggplot(df, aes(x = VIX, y = HiTec_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_hl <- ggplot(df, aes(x = VIX, y = Hlth_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_o <- ggplot(df, aes(x = VIX, y = Other_R)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_c + g_m + g_hi + g_hl + g_o
```
```{r}
g_c <- ggplot(df2021, aes(x = VIX, y = Cnsmr_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_m <- ggplot(df2021, aes(x = VIX, y = Manuf_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_hi <- ggplot(df2021, aes(x = VIX, y = HiTec_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_hl <- ggplot(df2021, aes(x = VIX, y = Hlth_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_o <- ggplot(df2021, aes(x = VIX, y = Other_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_c + g_m + g_hi + g_hl + g_o
```





Q3) Are there any more appropriate regions to use VIX?

To answer this question, we analyzed the return data on regions' value-weight market portfolio in North America, Europe, Asia, and Japan. They represent the average market return in each area.

The below graph created by the ggpairs function in GGally package shows scatter plots, density distribution, and correlations between the VIX and the returns. 

```{r}
df_p <- df[names(df) %in% c("VIX", "NA_R_n", "ERP_R_n",
                            "ASA_R_n", "JP_R_n")]
ggpairs(df_p) +
  labs(subtitle = "Pairwise Analysis for VIX and Non-positive Return in Each Area")
```

```{r}
df_V5 <- df %>% mutate(VIX = VIX * 5 - 400)
df_c <- df_V5 %>% select(DATE, NA_V, ERP_V, ASA_V,
                         JP_V, VIX) %>% gather(key, Value, -DATE)
ggplot() +
  annotate("rect", xmin = as.Date("2002-7-1"), xmax = as.Date("2003-6-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2008-8-1"), xmax = as.Date("2009-7-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2011-7-1"), xmax = as.Date("2012-2-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  annotate("rect", xmin = as.Date("2020-2-1"), xmax = as.Date("2021-3-1"),
           ymin = -Inf, ymax = Inf, fill = "green", alpha = 0.2) +
  layer(
    data = df_c, 
    mapping = aes(DATE, Value, col = key, alpha = 0.8), 
    geom = "line", 
    stat = "identity", 
    position = "identity"
  ) +
  geom_smooth(df_V5, mapping = aes(DATE, VIX),
              method = "loess", span = 0.1, colour = "red") +
  annotate("text", x = as.Date("2003-6-1"), y = -100,
           label = "Jul. 02 - May 03", color = "black", hust = 0) +
  annotate("text", x = as.Date("2009-7-1") - 300, y = -20,
           label = "Aug. 08 - Jun. 09", color = "black", hust = 0) +
  annotate("text", x = as.Date("2012-2-1") + 300, y = -100,
           label = "Jul. 11 - Jan. 12", color = "black", hust = 0) +
  annotate("text", x = as.Date("2021-3-1") - 500, y = -20,
           label = "Feb. 20 - Feb. 21", color = "black", hust = 0) +
  labs(subtitle = "Comparison of US Value and VIX") +
  theme_grey(16)
```
```{r}
g_na <- ggplot(df, aes(x = VIX, y = NA_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_erp <- ggplot(df, aes(x = VIX, y = ERP_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_asa <- ggplot(df, aes(x = VIX, y = ASA_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_jp <- ggplot(df, aes(x = VIX, y = JP_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_na + g_erp + g_asa + g_jp

```

```{r}
g_na <- ggplot(df2021, aes(x = VIX, y = NA_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_erp <- ggplot(df2021, aes(x = VIX, y = ERP_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_asa <- ggplot(df2021, aes(x = VIX, y = ASA_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_jp <- ggplot(df2021, aes(x = VIX, y = JP_R_n)) +
  geom_point(alpha = 0.2, shape = 1, position = "jitter")  +
  geom_boxplot(aes(group = bin)) + geom_smooth()
g_na + g_erp + g_asa + g_jp
```


<!-- So we can see a slight correlation - now we look at changes in the VIX vs changes in returns. -->

<!-- ```{r} -->


<!-- df1 <- df %>% mutate(dVIX=VIX - lag(VIX)) -->
<!-- ggplot(df1,aes(x=dVIX,y=US_Return)) + geom_point( alpha = 0.2,shape=1,position = "jitter") + geom_smooth() -->

<!-- df2 <- df1 %>% mutate(dVIX_t1=lag(dVIX)) -->
<!-- ggplot(df2,aes(x=dVIX_t1,y=US_Return)) + geom_point( alpha = 0.2,shape=1,position = "jitter") + geom_smooth() -->
<!-- ``` -->

